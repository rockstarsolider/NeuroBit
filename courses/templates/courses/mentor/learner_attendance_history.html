{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden bg-slate-50">
    <div class="layout-container flex h-full grow flex-col">
        <main class="flex-1 px-4 py-8 sm:px-6 md:px-10">
            <div class="mx-auto max-w-5xl">

                <!-- Back Button -->
                <div class="mb-8 flex items-center gap-4">
                    <a class="flex items-center gap-2 text-sm font-medium text-secondary-600 transition-colors hover:text-primary-500"
                        href="/learners_list">
                        <span class="material-symbols-outlined">arrow_back</span>
                        <span>Back to Learner List</span>
                    </a>
                </div>

                <!-- Page Header -->
                <div class="mb-8">
                    <h1 class="text-3xl font-bold tracking-tight text-secondary-900">
                        Learner Attendance History
                    </h1>
                    <p class="mt-1 text-secondary-500">
                        Review all group & private session attendance for this learner.
                    </p>
                </div>

                <!-- Learner Card -->
                <div class="mb-8 flex flex-col gap-6 rounded-lg border border-[#e2e8f0] bg-white p-6 sm:flex-row sm:items-center">
                    <div class="shrink-0">
                        {% if learner.user.image %}
                            <img src="{{ learner.user.image.url }}" class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border-2 border-slate-200" alt="Profile">
                        {% else %}
                            <img src="{% static 'images/default_user_image.jpg' %}" class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border-2 border-slate-200" alt="Default Profile">
                        {% endif %}
                    </div>
                    <div class="flex flex-col">
                        <h2 class="text-2xl font-bold text-secondary-900">
                            {{ learner.user.get_full_name }}
                        </h2>
                        <p class="text-base text-secondary-500">
                            {{ learner.user.email }}
                        </p>
                    </div>
                </div>

                <!-- Attendance Box -->
                <div class="rounded-lg border border-[#e2e8f0] bg-white">

                    <div class="border-b border-[#e2e8f0] p-4 sm:p-6">
                        <h3 class="text-xl font-bold text-secondary-900">Attendance Records</h3>

                        <!-- Filters -->
                        <form 
                            hx-get="."
                            hx-target="#records-table"
                            hx-trigger="change"
                            class="mt-4 flex flex-col gap-4 sm:flex-row sm:items-end"
                        >
                            <!-- Session Type -->
                            <div class="relative flex-1">
                                <label class="block pb-2 text-sm font-medium text-secondary-700">Session Type</label>
                                <select name="type"
                                    class="form-input h-12 w-full rounded-md border-[#e2e8f0]">
                                    <option value="">All</option>
                                    <option value="group" {% if session_type_filter == 'group' %}selected{% endif %}>Group</option>
                                    <option value="private" {% if session_type_filter == 'private' %}selected{% endif %}>Private</option>
                                </select>
                            </div>

                            <!-- Presence -->
                            <div class="relative flex-1">
                                <label class="block pb-2 text-sm font-medium text-secondary-700">Presence</label>
                                <select name="presence"
                                    class="form-input h-12 w-full rounded-md border-[#e2e8f0]">
                                    <option value="">All</option>
                                    <option value="present" {% if presence_filter == 'present' %}selected{% endif %}>Present</option>
                                    <option value="absent" {% if presence_filter == 'absent' %}selected{% endif %}>Absent</option>
                                </select>
                            </div>
                        </form>
                    </div>

                    <!-- Records Table -->
                    <div id="records-table" class="overflow-x-auto">
                        {% include "courses/partials/learner_attend_history_table.html" %}
                        
                    </div>

                </div>
            </div>
        </main>
    </div>
</div>
{% endblock %}
