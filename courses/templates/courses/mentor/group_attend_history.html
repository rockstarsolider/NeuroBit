{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="flex flex-col min-h-screen bg-slate-50">
    <main class="grow">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
            <div class="space-y-8">
                <div>
                    <a class="inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-[var(--brand-primary)] transition-colors"
                        href="/session_list">
                        <span class="material-symbols-outlined">arrow_back</span>
                        Back to Session History
                    </a>
                </div>

                <div class="bg-white p-6 sm:p-8 rounded-xl shadow-sm border border-gray-200">
                    <div class="flex flex-col md:flex-row justify-between items-start gap-4 mb-6">
                        <div>
                            <h2 class="text-3xl font-bold text-[var(--brand-text-primary)]">
                                {{occurrence.mentor_group_session.session_type}} - {{occurrence.mentor_group_session.learning_path}}
                            </h2>
                            <div class="mt-2 flex items-center gap-4 text-gray-500">

                                <!-- Date And Time -->
                                <div class="flex items-center gap-2">
                                    <span class="material-symbols-outlined text-lg">calendar_today</span>
                                    <span>{%if occurrence.occurence_datetime_changed %} {{occurrence.new_datetime|date}} {% else %} {{occurrence.occurence_datetime|date}} {% endif %}</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="material-symbols-outlined text-lg">schedule</span>
                                    <span>{%if occurrence.occurence_datetime_changed %} {{occurrence.new_datetime|time}} {% else %} {{occurrence.occurence_datetime|time}} {% endif %}</span>
                                </div>

                                <!-- Recorded Video Link -->
                                <div class="flex items-center gap-2">
                                    <span class="material-symbols-outlined">link</span>
                                    <a class='text-(--primary-color)' href='{{occurrence.session_video_record}}'>{{occurrence.session_video_record}}</a>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                                        scope="col">
                                        Participant Name
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                                        scope="col">
                                        Attendance Status
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                {% for p in participants %}
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <!-- User Image -->
                                                <div class="flex-shrink-0 h-10 w-10">
                                                    {% if p.mentor_assignment.enrollment.learner.user.image %}
                                                        <img src="{{ p.mentor_assignment.enrollment.learner.user.image.url }}" class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border-2 border-slate-200" alt="Profile">
                                                    {% else %}
                                                        <img src="{% static 'images/default_user_image.jpg' %}" class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border-2 border-slate-200" alt="Default Profile">
                                                    {% endif %}
                                                </div>

                                                <div class="ml-4">
                                                    <div class="text-sm font-medium text-gray-900">{{p.mentor_assignment.enrollment.learner.user.get_full_name}}</div>
                                                    <div class="text-sm text-gray-500">{{p.mentor_assignment.enrollment.learner.user.email}}</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            {% if p.learner_was_present %}
                                                <span
                                                    class="inline-flex items-center px-3 py-1 text-sm font-medium rounded-full bg-[#D1FAE5] text-[var(--status-present-text)]">
                                                    <span class="material-symbols-outlined text-base mr-1.5">check_circle</span>
                                                    Present
                                                </span>
                                            {% else %}
                                                <span
                                                    class="inline-flex items-center px-3 py-1 text-sm font-medium rounded-full bg-[#FEE2E2] text-[var(--status-absent-text)]"> 
                                                    <span class="material-symbols-outlined text-base mr-1.5">cancel</span>
                                                    Absent
                                                </span>
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>
{% endblock %}