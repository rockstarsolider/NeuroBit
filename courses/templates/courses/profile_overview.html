{% extends "base.html" %}
{% load i18n %}
{% load static %}

{% block content %}
<div class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-slate-50">
    <main class="grow">
        <div class="mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
            <div class="mx-auto max-w-4xl">
                <div class="mb-12 rounded-lg border border-gray-200 bg-white p-6 shadow-sm">
                    <div class="flex flex-col items-center gap-6 sm:flex-row">
                        <div class="relative">
                            <div class="h-32 w-32 rounded-full bg-cover bg-center ring-4 ring-white"
                            style="background-image: url('{% if profile_user.user.image %}{{ profile_user.user.image.url }}{% else %}{% static "images/default_user_image.jpg" %}{% endif %}');">
                            </div>
                        </div>
                        <div class="text-start">
                            <h2 class="text-3xl font-bold text-gray-900">{{profile_user}}</h2>
                            <p class="text-md mt-2 ">{{profile_user.user.email}}</p>
                            <p class="mt-2 text-sm  max-w-md">{{profile_user.bio|safe}}</p>

                            {% if is_mentor %}
                                <p class="mt-2 font-bold max-w-md">Specialities:</p>
                                {% for s in profile_user.specialties.all %}
                                    <p class="mt-2 text-sm text-gray-800 max-w-md">{{s}} -</p>
                                {% endfor %}
                            {% endif %}
                        </div>

                        {% if profile_user.user == user %}
                            <div class="ml-auto shrink-0">
                                <a
                                    href='{% url "edit-profile" %}'
                                    class="inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
                                    <span class="material-symbols-outlined mr-2 -ml-1 h-5 w-5"> edit </span>
                                    {% trans 'Edit Profile'%}
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
                {% if is_mentor == false %}
                    <div class="space-y-10">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900 mb-4">{% trans 'Completed Learning Paths' %}</h3>
                            <div class="space-y-4">
                                {% for path in completed_paths %}
                                    <a class="block rounded-lg border border-gray-200 bg-white p-4 shadow-sm transition-all hover:shadow-md hover:border-primary-200"
                                        href="{% url 'learning-path' path.enrollment %}">
                                        <div class="flex items-center gap-4">
                                            <div
                                                class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-primary-100 text-primary-600">
                                                <span class="material-symbols-outlined"> verified </span>
                                            </div>
                                            <div class="grow">
                                                <p class="font-semibold text-gray-800">{{path.path}}</p>
                                                <p class="text-sm text-gray-500">{{path.completed_date}}</p>
                                            </div>
                                            <span class="material-symbols-outlined text-gray-400"> chevron_right </span>
                                        </div>
                                    </a>
                                {% endfor %}
                            </div>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900 mb-4">{% trans 'In Progress Learning Paths'%}</h3>
                            <div class="space-y-4">
                                {% for path in ongoing_paths %}
                                    <a class="block rounded-lg border border-gray-200 bg-white p-4 shadow-sm transition-all hover:shadow-md hover:border-primary-200"
                                        href="{% url 'learning-path' path.enrollment %}">
                                        <div class="flex items-center gap-4">
                                            <div class="relative h-12 w-12 shrink-0">
                                                <svg class="h-full w-full" height="36" viewBox="0 0 36 36" width="36"  transform="rotate(-90)"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <circle class="stroke-current text-gray-200" cx="18" cy="18" fill="none"
                                                        r="16" stroke-width="2"></circle>
                                                    <circle class="stroke-current text-primary-600" cx="18" cy="18" fill="none"
                                                        r="16" stroke-dasharray="100" stroke-dashoffset="{{path.progress_offset}}" stroke-width="2">
                                                    </circle>
                                                </svg>
                                                <div class="absolute inset-0 flex items-center justify-center">
                                                    <span class="text-xs font-semibold text-primary-700">{{path.progress}}%</span>
                                                </div>
                                            </div>
                                            <div class="grow">
                                                <p class="font-semibold text-gray-800">{{path.path}}</p>
                                            </div>
                                            <span class="material-symbols-outlined text-gray-400"> chevron_right </span>
                                        </div>
                                    </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </main>
</div>
{% endblock %}